{% block content %}
{% include "header.html" %}
<form action="{{url_for('editProject', proj_id=item.project.id, item_id=item.id)}}" method="post">
    
    <div class="container-fulid mt-4 ml-1">
        <div class="row">
            <!-- project details form -->
            <div class="col-4 mt-4 mb-1">
                <div class="projectdetails-form shadow" >
                    <h6 class="projectdetail_heading"><b>Project Details</b></h6>
                    <hr>
                    <div class="row mt-2">
                        <div class="col-6">
                            <label for="cname">Customer Name</label>
                        </div>
                        <div class="col-6">
                            <select name="cname" class="form-control-sm-sm projectdetail_input" id="company"></select>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="address">Address</label>
                        </div>
                        <div class="col-6">
                            <select name="address" id="address" class="form-control-sm-sm projectdetail_input"></select>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="cname">End User</label>
                        </div>
                        <div class="col-6">
                            <select name="cnameE" id="companyE" class="form-control-sm-sm projectdetail_input"></select>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="address">End User Address</label>
                        </div>
                        <div class="col-6">
                            <select name="addressE" id="addressE" class="form-control-sm-sm projectdetail_input"></select>
                        </div>
                    </div>
                    
                    <div class="row  mt-1">
                        <div class="col-6">
                            <label for="pro">Project Name</label>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control-sm-sm projectdetail_input" name="projectRef"
                                 required value="{{project.projectRef}}">
                        </div>
                    </div>
                    <div class="row  mt-1">
                        <div class="col-6">
                            <label for="pro">Enquiry Ref.</label>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control-sm-sm projectdetail_input" name="enquiryRef"
                             required value="{{project.enquiryRef}}">
                        </div>
                    </div>
                    <div class="row  mt-1">
                        <div class="col-6">
                            <label for="enquiry">Enquiry Date</label>
                        </div>
                        <div class="col-6">
                            <input type="date" class="form-control-sm-sm projectdetail_input" name="enquiryReceivedDate"
                                value="{{project.enquiryReceivedDate.date()}}">
                        </div>
                    </div>
                    <div class="row  mt-1">
                        <div class="col-6">
                            <label for="received">Receipt Date</label>
                        </div>
                        <div class="col-6">
                            <input type="date" class="form-control-sm-sm projectdetail_input" name="receiptDate"
                             value="{{project.receiptDate.date()}}">
                        </div>
                    </div>
                    <div class="row  mt-1">
                        <div class="col-6">
                            <label for="bid due">Bid Due Date</label>
                        </div>
                        <div class="col-6">
                            <input type="date" class="form-control-sm-sm projectdetail_input" name="bidDueDate"
                             value="{{project.bidDueDate.date()}}">
                        </div>
                    </div>
                    <div class="row  mt-1 ">
                        <div class="col-6 pr-0">
                            <label for="application_eng">Application Engineer</label>
                        </div>
                        <div class="col-6">
                            <select class="form-control-sm-sm projectdetail_select" name="aEng"
                                id="application_eng" style="width: 100%;">
                                {% for engineer in metadata['engineers'] %}
                                    {% if engineer.id == eng_a %}
                                    <option value="{{engineer.id}}" selected>{{engineer.name}}</option>
                                    {% else %}
                                    <option value="{{engineer.id}}">{{engineer.name}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row  mt-1 ">
                        <div class="col-6">
                            <label for="purpose">Purpose</label>
                        </div>
                        <div class="col-6">
                            <select class="form-control-sm-sm projectdetail_select" name="purpose" id="purpose">
                                
                                {% for purpose in metadata['purpose'] %}
                                    {% if project.purpose == purpose%}
                                        <option value="{{purpose}}" selected>{{purpose}}</option>
                                    {% else %}
                                        <option value="{{purpose}}">{{purpose}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row  mt-1 ">
                        <div class="col-6">
                            <label for="Industry">Industry</label>
                        </div>
                        <div class="col-6">
                            <select class="form-control-sm-sm projectdetail_select" name="industry" id="Industry">
                                
                                {% for industry in metadata['industries'] %}
                                    {% if project.industry.name == industry.name %}
                                        <option value="{{industry.id}}" selected>{{industry.name}}</option>
                                    {% else %}
                                        <option value="{{industry.id}}">{{industry.name}}</option>
                                    {% endif%}
                                {% endfor %}
                                <!-- <option value="Paper & Board">Paper & Board</option>
                            <option value="Petrochemical">Petrochemical</option>   -->
                            </select>
                        </div>
                    </div>

                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="project ">Region</label>
                        </div>
                        <div class="col-6">
                            <select class="form-control-sm-sm projectdetail_select" name="region" id="region">
                                
                                {% for region in metadata['regions'] %}
                                    {% if project.region.name == region.name %}
                                        <option value="{{region.id}}" selected>{{region.name}}</option>
                                    {% else %}
                                        <option value="{{region.id}}">{{region.name}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>
             

                </div>
            </div>
            <!-- order information form -->
            <div class="col-4 mt-4">
                <div class="orderinformation-form shadow">
                    <h6 ><b>Order Information</b></h6>
                    <hr>
                    <div class="row  mt-1 ">
                        <div class="col-6">
                            <label for="Contract Engineer">Contract Engineer</label>
                        </div>
                        <div class="col-6">
                            <select class="form-control-sm-sm projectdetail_select" name="cEng"
                                id="Contract Engineer">
                                {% for engineer in metadata['engineers'] %}
                                    {% if engineer.id == eng_c %}
                                    <option value="{{engineer.id}}" selected>{{engineer.name}}</option>
                                    {% else %}
                                    <option value="{{engineer.id}}">{{engineer.name}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="Customer Po No">Customer PO No</label>
                        </div>
                        <div class="col-6">
                            <input type="text"class="form-control-sm-sm projectdetail_input" name="custPoNo" value="{{project.custPoNo}}"
                                style="width: 100%;">
                        </div>
                    </div>

                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="Work Order No">Work Order No</label>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control-sm-sm projectdetail_input"  name="workOderNo" value="{{project.workOderNo}}"
                                style="width: 100%;">
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-6">
                            <label for="status">Status</label>
                        </div>
                        <div class="col-6">
                            <select name="status"  id=""  class="form-control-sm-sm projectdetail_input">
                                {% for stat in metadata['status'] %}
                                    {% if project.status == stat %}
                                        <option value="{{stat}}" selected>{{stat}}</option>
                                    {% else %}
                                        <option value="{{stat}}">{{stat}}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-3">

            </div>



        </div>

    </div>
    
</div>
</div>
<div class="row ">
    <div class="col-12 fixed-bottom d-flex justify-content-end mb-3">
        <button type="submit" class="btn btn-info btn-sm projectdetail_btn">Update Project</button>
    </div>
</div>
</form>




<script>
    // alert('js working')
    var companyObject = JSON.parse({{dropdown|tojson}});
    var companyObject2 = JSON.parse({{dropdown2|tojson}});
    // console.log(companyObject, companyObject2)

    window.onload = function() {
      var notesSelect = document.getElementById("company");
      var nvaluesSelect = document.getElementById("address");
      var notesSelectE = document.getElementById("companyE");
      var nvaluesSelectE = document.getElementById("addressE");
      firstKey = Object.keys(companyObject)[0]
      firstKey2 = Object.keys(companyObject2)[0]
      for (var x in companyObject) {
        notesSelect.options[notesSelect.options.length] = new Option(x, x);
      }

      for (var x in companyObject2) {
        notesSelectE.options[notesSelectE.options.length] = new Option(x, x);
      }


    //   console.log(firstKey)

      if (nvaluesSelect.options.length === 0){
        
        // console.log(companyObject[`${firstKey}`])
        for (var y in companyObject[`${firstKey}`]) {
          nvaluesSelect.options[nvaluesSelect.options.length] = new Option(companyObject[firstKey][y], companyObject[firstKey][y]);
        }
      }

      if (nvaluesSelectE.options.length === 0){
        
        // console.log(companyObject2[`${firstKey2}`])
        for (var y in companyObject2[`${firstKey2}`]) {
          nvaluesSelectE.options[nvaluesSelectE.options.length] = new Option(companyObject2[firstKey][y], companyObject2[firstKey][y]);
        }
      }

      

      notesSelect.onchange = function() {
        //empty Chapters- and Topics- dropdowns
        nvaluesSelect.length = 0;
        //display correct values
        // console.log(companyObject[this.value])
        for (var y in companyObject[this.value]) {
        //   console.log(y)
          nvaluesSelect.options[nvaluesSelect.options.length] = new Option(companyObject[this.value][y], companyObject[this.value][y]);
        }
      }

      notesSelectE.onchange = function() {
        //empty Chapters- and Topics- dropdowns
        nvaluesSelectE.length = 0;
        //display correct values
        // console.log(companyObject[this.value])
        for (var y in companyObject2[this.value]) {
        //   console.log(y)
          nvaluesSelectE.options[nvaluesSelectE.options.length] = new Option(companyObject2[this.value][y], companyObject2[this.value][y]);
        }
      }
      
    }
    </script>


{% include "footer.html" %}
{% endblock %}